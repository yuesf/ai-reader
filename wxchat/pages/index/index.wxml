<!--index.wxml - åšå®¢é¦–é¡µ-->
<view class="blog-container">
  <!-- é¡¶éƒ¨å“ç‰ŒåŒºåŸŸ -->
  <view class="blog-header">
    <view class="brand-section">
      <text class="blog-title">AI Reader</text>
      <text class="blog-subtitle">æ™ºèƒ½é˜…è¯»ï¼Œæ·±åº¦æ´å¯Ÿ</text>
    </view>
  </view>

  <!-- å¿«é€Ÿå¯¼èˆªåŒºåŸŸ -->
  <view class="nav-section">
    <scroll-view class="category-nav" scroll-x="true" show-scrollbar="false">
      <view class="nav-item {{currentCategory === '' ? 'active' : ''}}" 
            bindtap="onCategoryTap" 
            data-category="">
        å…¨éƒ¨
      </view>
      <view class="nav-item {{currentCategory === item ? 'active' : ''}}" 
            wx:for="{{categories}}" 
            wx:key="*this"
            bindtap="onCategoryTap" 
            data-category="{{item}}">
        {{item}}
      </view>
    </scroll-view>
    
    <view class="nav-actions">
      <button class="search-btn" bindtap="onSearchTap">ğŸ”</button>
      <button class="all-reports-btn" bindtap="onAllReportsTap">å…¨éƒ¨æŠ¥å‘Š</button>
    </view>
  </view>

  <!-- æœç´¢åŒºåŸŸï¼ˆå¯å±•å¼€ï¼‰ -->
  <view class="search-section {{showSearch ? 'show' : ''}}">
    <view class="search-bar">
      <input 
        class="search-input" 
        placeholder="æœç´¢åšå®¢å†…å®¹..." 
        value="{{searchKeyword}}"
        bindinput="onSearchInput"
        confirm-type="search"
        bindconfirm="onSearch"
      />
      <button class="search-confirm-btn" bindtap="onSearch">æœç´¢</button>
      <button class="search-close-btn" bindtap="onSearchClose">âœ•</button>
    </view>
  </view>

  <!-- åšå®¢å†…å®¹åŒºåŸŸ -->
  <view class="blog-content">
    <!-- ç²¾é€‰æ¨è -->
    <view class="featured-section" wx:if="{{featuredArticles.length > 0}}">
      <view class="section-header">
        <text class="section-title">ğŸ“Œ ç²¾é€‰æ¨è</text>
      </view>
      <scroll-view class="featured-scroll" scroll-x="true" show-scrollbar="false">
        <view class="featured-item" 
              wx:for="{{featuredArticles}}" 
              wx:key="id"
              bindtap="onArticleTap"
              data-id="{{item.id}}"
              data-type="featured">
          <image class="featured-cover" src="{{item.coverImage}}" mode="aspectFill"></image>
          <view class="featured-info">
            <text class="featured-title">{{item.title}}</text>
            <text class="featured-summary">{{item.summary}}</text>
            <view class="featured-meta">
              <text class="featured-category">{{item.category}}</text>
              <text class="featured-date">{{item.publishDate}}</text>
            </view>
          </view>
        </view>
      </scroll-view>
    </view>

    <!-- æœ€æ–°æ–‡ç«  -->
    <view class="latest-section">
      <view class="section-header">
        <text class="section-title">ğŸ†• æœ€æ–°å‘å¸ƒ</text>
        <text class="section-more" bindtap="onAllReportsTap">æŸ¥çœ‹æ›´å¤š â†’</text>
      </view>
      
      <!-- åŠ è½½çŠ¶æ€ -->
      <view class="loading-container" wx:if="{{loading && articles.length === 0}}">
        <view class="loading-spinner"></view>
        <text class="loading-text">åŠ è½½ä¸­...</text>
      </view>

      <!-- æ–‡ç« åˆ—è¡¨ -->
      <view class="article-list">
        <view class="article-item" 
              wx:for="{{filteredArticles}}" 
              wx:key="id"
              bindtap="onArticleTap"
              data-id="{{item.id}}"
              data-type="article">
          
          <view class="article-cover">
            <image class="cover-img" src="{{item.coverImage}}" mode="aspectFill"></image>
          </view>
          
          <view class="article-content">
            <view class="article-title">{{item.title}}</view>
            <view class="article-summary">{{item.summary}}</view>
            
            <view class="article-tags" wx:if="{{item.tags && item.tags.length > 0}}">
              <text class="article-tag" wx:for="{{item.tags}}" wx:key="*this" wx:for-item="tag">{{tag}}</text>
            </view>
            
            <view class="article-meta">
              <text class="article-category">{{item.category}}</text>
              <text class="article-date">{{item.publishDate}}</text>
              <text class="article-read">{{item.readCount || 0}}æ¬¡é˜…è¯»</text>
            </view>
            
            <view class="article-actions">
              <button class="action-btn summary-btn" 
                      bindtap="onReadSummary" 
                      data-id="{{item.id}}"
                      catchtap="true">
                é˜…è¯»æ‘˜è¦
              </button>
              <button class="action-btn report-btn" 
                      bindtap="onViewReport" 
                      data-id="{{item.id}}"
                      catchtap="true">
                æŸ¥çœ‹æŠ¥å‘Š
              </button>
            </view>
          </view>
        </view>
      </view>

      <!-- æ— æœç´¢ç»“æœæç¤º -->
      <view class="no-results" wx:if="{{filteredArticles.length === 0 && !loading && searchKeyword}}">
        <text>æœªæ‰¾åˆ°ç›¸å…³å†…å®¹</text>
      </view>

      <!-- ç©ºçŠ¶æ€æç¤º -->
      <view class="empty-state" wx:if="{{filteredArticles.length === 0 && !loading && !searchKeyword}}">
        <text>æš‚æ— åšå®¢å†…å®¹</text>
      </view>

      <!-- åŠ è½½æ›´å¤š -->
      <view class="load-more" wx:if="{{filteredArticles.length > 0}}">
        <view wx:if="{{loading}}" class="loading-more">
          <view class="loading-spinner small"></view>
          <text>åŠ è½½ä¸­...</text>
        </view>
        <view wx:elif="{{!hasMore}}" class="no-more">
          <text>å·²åŠ è½½å…¨éƒ¨å†…å®¹</text>
        </view>
        <view wx:else class="pull-up" bindtap="onLoadMore">
          <text>ç‚¹å‡»åŠ è½½æ›´å¤š</text>
        </view>
      </view>
    </view>
  </view>
</view>
